/*
 * $Id: gets3.c,v 1.1 2004/09/15 17:54:39 raptor Exp $
 *
 * heap9.c - vulnerable code by <fuzzy@bonbon.net>
 * Copyright (c) 2004 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See http://www.securityfocus.com/archive/82/375056
 */

/* vuln.c */
/* familiar? ... */
#define LEN 256

int main(void) {

        char *buf1 = (char *)malloc(LEN);
        char *buf2 = (char *)malloc(LEN);

        printf("buf1: %p\n", buf1);
        printf("buf2: %p\n", buf2);
        gets(buf1);  
        free(buf2);
        free(buf1);
}
