/* 
 * $Id: fp5.c,v 1.1.1.1 2004/05/29 14:15:04 raptor Exp $
 *
 * fp5.c - simple vulnerable program (the 0-byte technique)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See "Radical Environmentalists Part II: the 0-byte technique", by
 * gloomy & the itch from Netric Security Team.
 */

#include <stdio.h>
#include <stdlib.h>

#define	NR_OF_DATA	4

struct __data {
	unsigned long id;
};

void getdata(int nr, char *str[])
{
	struct __data data[NR_OF_DATA];
	int counter;

	for (counter = 0; counter <= NR_OF_DATA && nr > counter + 1; counter++)
		data[counter].id = strtoul(str[counter+1], &str[counter+1], 16);
}

int main(int c, char *v[])
{
	getdata(c, v);
	return(0);
}
