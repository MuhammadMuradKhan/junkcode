/*
 * $Id: fp2.c,v 1.1.1.1 2004/05/29 14:15:04 raptor Exp $
 *
 * fp2.c - simple vulnerable program (frame pointer overwrite)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Example vulnerable program for NULL byte poisoning and frame pointer 
 * overwrite technique, via strncat(): this function always add a terminating
 * NULL byte, the string must have sufficient space to hold the result.
 */

func(char *sm)
{
	char buffer[256] = "fubar";
	char entry[1024];

	strncpy(entry, sm, sizeof(buffer) - strlen(buffer));
	entry[sizeof(entry) - 1] = '\0';

	strncat(buffer, entry, sizeof(buffer) - strlen(buffer));

	printf("%s\n", buffer);
}

int main(int argc, char *argv[])
{
	if (argc > 1)
		func(argv[1]);
}
