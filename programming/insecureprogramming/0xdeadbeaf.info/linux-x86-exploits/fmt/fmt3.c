/*
 * $Id: fmt3.c,v 1.1.1.1 2004/05/29 14:15:04 raptor Exp $
 *
 * fmt3.c - vulnerable program (format string exploitation)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See http://www.team-teso.net/articles/formatstring/, by scut.
 */

int main(int argc, char **argv)
{
	char buf[512];
	char *usr = (char *)calloc(1, strlen(argv[1]));

	memcpy(usr, argv[1], strlen(argv[1]));

	snprintf(buf, sizeof(buf), usr);
	buf[sizeof(buf) - 1] = 0x0;

	printf("%s\n", buf);
}
