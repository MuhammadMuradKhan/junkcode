/*
 * $Id: fmt4.c,v 1.1.1.1 2004/05/29 14:15:04 raptor Exp $
 *
 * fmt4.c - vulnerable program (format string exploitation)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See http://www.team-teso.net/articles/formatstring/, by scut.
 */

#include <stdio.h>

int main(int argc, char **argv)
{
	FILE *f;
	char buffer[512];

	snprintf(buffer, sizeof(buffer), argv[1]);
	buffer[sizeof(buffer) - 1] = 0x0;

	printf("%s\n", buffer);

	f = fopen(buffer, "r");
}
