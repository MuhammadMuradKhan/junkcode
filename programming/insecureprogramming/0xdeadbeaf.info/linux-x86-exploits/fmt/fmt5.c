/*
 * $Id: fmt5.c,v 1.1.1.1 2004/05/29 14:15:04 raptor Exp $
 *
 * fmt5.c - vulnerable program (format string exploitation)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See http://www.team-teso.net/articles/formatstring/, by scut.
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void foo (char *line);

int
main (int argc, char *argv[])
{
	FILE *	f;
	char	line[1024];

	f = fopen (argv[1], "rb");
	if (f == NULL) {
		fprintf (stderr, "usage: %s file\n", argv[0]);

		exit (EXIT_FAILURE);
	}

	fgets (line, sizeof (line) - 1, f);
	line[1023] = '\x00';

	foo (line);

	fclose(f);

	exit (EXIT_SUCCESS);
}

void
foo (char *line)
{
	printf (line);
}
