/*
 * $Id: nonterm1.c,v 1.1.1.1 2004/05/29 14:15:05 raptor Exp $
 *
 * nonterm1.c - simple vulnerable program (non-term string)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Example vulnerable program by twitch <twitch@vicar.org>. 
 * See http://www.phrack.org/phrack/56/p56-0x0e for details about 
 * "Taking advantage of non-terminated adjacent memory spaces".
 */

#define CONDITION	1

void print_error(char *p)
{
	char mybuf[263];

	sprintf(mybuf, "error: %s", p);
}

int main(int argc, char *argv[])
{
	char buf1[1024];
	char buf2[256];

	strncpy(buf1, argv[1], 1024);
	strncpy(buf2, argv[2], 256);

	if (CONDITION) 
		print_error(buf2);
}
