/*
 * $Id: sg4.c,v 1.1.1.1 2004/05/29 14:15:05 raptor Exp $
 *
 * sg4.c - simple vulnerable program (stackguard + non-exec)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Example vulnerable program, see http://www.phrack.org/phrack/56/p56-0x05
 * for the excellent paper by Bulba and Kil3r <lam3rz@hert.org>.
 */

char global_buf[64];

void f(char *string, char *dst)
{
	char a[64];

	strcpy(a, string);
	strncpy(dst, a, 64);

	printf("foo\n");
}

int main(int argc, char **argv) 
{
	f(argv[1], global_buf);
}
