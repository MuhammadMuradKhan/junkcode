/*
 * $Id: sg2.c,v 1.1.1.1 2004/05/29 14:15:05 raptor Exp $
 *
 * sg2.c - simple vulnerable program (stackguard + non-exec)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Example vulnerable program, see http://www.phrack.org/phrack/56/p56-0x05
 * for the excellent paper by Bulba and Kil3r <lam3rz@hert.org>.
 */

void f (char ** argv)
{
	int pipa;       // useless variable
	char *p;
	char a[30];

	p = a;

	strcpy(p, argv[1]);
	strncpy(p, argv[2], 16);
}

int main (int argc, char **argv)
{
	f(argv);
	printf("foo\n");
}
