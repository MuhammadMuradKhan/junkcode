/*
 * $Id: sg3.c,v 1.1.1.1 2004/05/29 14:15:05 raptor Exp $
 *
 * sg3.c - simple vulnerable program (stackguard + non-exec)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Example vulnerable program, see http://www.phrack.org/phrack/56/p56-0x05
 * for the excellent paper by Bulba and Kil3r <lam3rz@hert.org>.
 */

char dst_buffer[64];

void f(char *string)
{
	char *p;
	char a[64];

	p = dst_buffer;

	strcpy(a, string);
	strncpy(p, a, 64);

	printf("foo\n");
}

int main(int argc, char **argv) 
{
	f(argv[1]);
}
