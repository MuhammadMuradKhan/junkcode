/*
 * $Id: heap2.c,v 1.1.1.1 2004/05/29 14:15:05 raptor Exp $
 *
 * heap2.c - vulnerable code by Michel "MaXX" Kaempf
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See http://www.phrack.org/phrack/57/p57-0x08
 */

#include <stdlib.h>
#include <string.h>

int main(int argc, char *argv[])
{
	char *first, *second, *third, *fourth, *fifth, *sixth;

	first = malloc(strlen(argv[2]) + 1);
	second = malloc(1500);
	third = malloc(12);
	fourth = malloc(666);
	fifth = malloc(1508);
	sixth = malloc(12);

	strcpy(first, argv[2]);
	free(fifth);
	strcpy(fourth, argv[1]);
	free(second);

	return(0);
}
