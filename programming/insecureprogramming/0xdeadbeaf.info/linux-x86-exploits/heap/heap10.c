/*
 * $Id: heap10.c,v 1.1 2004/11/05 11:03:30 raptor Exp $
 *
 * heap9.c - vulnerable code from the shellcoder's handbook
 * Copyright (c) 2004 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See http://www.wiley.com/compbooks/koziol/ (chapter 5)
 */

int main(int argc, char **argv)
{
	char 	*buf, *buf2, *buf3;

	buf = (char *)malloc(1024);
	buf2 = (char *)malloc(1024);
	buf3 = (char *)malloc(1024);

	free(buf2);

	strcpy(buf, argv[1]);
	buf2 = (char *)malloc(1024);

	printf("foo\n");
}
