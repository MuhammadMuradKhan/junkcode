/*
 * $Id: heap4.c,v 1.1.1.1 2004/05/29 14:15:05 raptor Exp $
 *
 * heap4.c - vulnerable code by Phantasmal Phantasmagoria
 * Copyright (c) 2004 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See http://seclists.org/lists/vuln-dev/2004/Feb/0025.html
 */

#include <stdio.h>

int main(int argc, char *argv[])
{
	char *first, *second;
	int x;

	first = (char *)malloc(1020);

	/* off-by-two */
	for (x = 0; x <= 1021 && argv[1][x] != '\0'; x++)
		first[x] = argv[1][x];

	second = (char *)malloc(1020);
	strcpy(second, "foo");

	printf("%p %p | %s\n", first, argv[1], second);
}
