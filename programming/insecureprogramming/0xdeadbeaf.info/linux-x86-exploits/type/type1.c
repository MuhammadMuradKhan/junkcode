/*
 * $Id: type1.c,v 1.1.1.1 2004/05/29 14:15:05 raptor Exp $
 *
 * type1.c - simple vulnerable program (type casting error)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Example vulnerable program for type casting error of len variable.
 */

#include <stdio.h>
#include <string.h>

func (char *domain)
{
	int len = domain[0];
	char buf[64];

	buf[0] = '\0';

	if (len >= 64) {
		fprintf(stderr, "overflow attempt!\n");
		return;
	}

	strncat(buf, &domain[1], len);
}

main (int argc, char *argv[])
{
	if (argc > 1)
		func(argv[1]);
}
