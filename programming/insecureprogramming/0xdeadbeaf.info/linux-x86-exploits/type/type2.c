/*
 * $Id: type2.c,v 1.1.1.1 2004/05/29 14:15:05 raptor Exp $
 *
 * type2.c - simple vulnerable program (non-term + type)
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Non-null termination in strncpy() and type casting error in strncat().
 */

#include <stdio.h>
#include <string.h>

main(int argc, char *argv[])
{
	int i = 5;
	char dest[8];

	if (argc > 2) {
		strncpy(dest, argv[1], sizeof(dest));
		strncat(dest, argv[2], sizeof(dest) - strlen(dest) - 1);
		printf("Value of i: %08x\n", i);
	}
}
