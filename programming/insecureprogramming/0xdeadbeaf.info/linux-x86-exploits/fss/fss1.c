/*
 * $Id: fss1.c,v 1.1.1.1 2004/05/29 14:15:04 raptor Exp $
 *
 * fss1.c - simple program vulnerable to file stream overflow
 * Copyright (c) 2003 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * See http://packetstormsecurity.nl/papers/unix/fstream-overflows.txt
 */

#include <stdio.h>

int main(int argc, char *argv[])
{
	FILE *test;
	char stage[256];
	char msg[] = "no segfault yet\n";

	test = fopen("foo", "a");
	strcpy(stage, argv[1]);
	fprintf(test, "%s", msg);

	exit(0);
}
